=============== 环境信息 ===============
hepnode1
Fri Mar 28 08:00:09 PM CST 2025
CUDA 库路径: /usr/local/cuda/targets/x86_64-linux/lib:

=============== 基本 CUDA 功能测试 ===============
========= CUDA 基础功能测试 =========
检测到 1 个 CUDA 设备
设备 0: NVIDIA L40
  计算能力: 8.9
  全局内存: 44.64 GB
  多处理器数量: 142
  时钟频率: 2490 MHz
  显存总线宽度: 384 bits
CUDA 内核错误: the provided PTX was compiled with an unsupported toolchain.

=============== cuBLAS 矩阵乘法测试 ===============
========= cuBLAS 矩阵乘法测试 =========
CUDA 内存: 总计 44.64 GB, 可用 44.22 GB

测试矩阵大小: 32 x 32
矩阵 A (32x32):
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
...

矩阵 B (32x32):
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
...

执行 cublasSgemm (N=32)...
结果矩阵 C (32x32):
   32.00    32.00    32.00    32.00    32.00    32.00 ...
   32.00    32.00    32.00    32.00    32.00    32.00 ...
   32.00    32.00    32.00    32.00    32.00    32.00 ...
   32.00    32.00    32.00    32.00    32.00    32.00 ...
   32.00    32.00    32.00    32.00    32.00    32.00 ...
   32.00    32.00    32.00    32.00    32.00    32.00 ...
...

矩阵乘法验证通过 (N=32)！

测试矩阵大小: 256 x 256
执行 cublasSgemm (N=256)...
矩阵乘法验证通过 (N=256)！

测试矩阵大小: 1024 x 1024
执行 cublasSgemm (N=1024)...
矩阵乘法验证通过 (N=1024)！

测试矩阵大小: 4096 x 4096
执行 cublasSgemm (N=4096)...
矩阵乘法验证通过 (N=4096)！

cuBLAS 测试完成!

=============== 特定 sgemm_cublas 函数测试 ===============
========= 测试你的 sgemm_cublas 函数 =========


===== 测试 1: M=4, N=3, K=1 =====
矩阵 A (4x1):
    0.83 
    0.86 
    0.77 
    0.15 
矩阵 B (3x1):
    0.93 
    0.35 
    0.86 
执行 GPU 矩阵乘法...
初始化 cuBLAS...
找到 1 个 CUDA 设备
成功设置 CUDA 设备 0
成功创建 cuBLAS 句柄
 ** On entry to SGEMM  parameter number 10 had an illegal value
执行 CPU 矩阵乘法...
GPU 结果 (3x4):
    0.00     0.00     0.00     0.00     0.00     0.00     0.00     0.00     0.00     0.00     0.00     0.00 CPU 结果 (3x4):
    0.77     0.80     0.72     0.14     0.29     0.30     0.27     0.05     0.71     0.74     0.66     0.13 不匹配: C_gpu[0] = 0.000000, C_cpu[0] = 0.771900
不匹配: C_gpu[1] = 0.000000, C_cpu[1] = 0.799800
不匹配: C_gpu[2] = 0.000000, C_cpu[2] = 0.716100
不匹配: C_gpu[3] = 0.000000, C_cpu[3] = 0.139500
不匹配: C_gpu[4] = 0.000000, C_cpu[4] = 0.290500
不匹配: C_gpu[5] = 0.000000, C_cpu[5] = 0.301000
不匹配: C_gpu[6] = 0.000000, C_cpu[6] = 0.269500
不匹配: C_gpu[7] = 0.000000, C_cpu[7] = 0.052500
不匹配: C_gpu[8] = 0.000000, C_cpu[8] = 0.713800
不匹配: C_gpu[9] = 0.000000, C_cpu[9] = 0.739600
验证失败: 发现 12 个不匹配的元素 (总共 12 个)

===== 测试 2: M=64, N=64, K=64 =====
执行 GPU 矩阵乘法...
初始化 cuBLAS...
执行 CPU 矩阵乘法...
不匹配: C_gpu[0] = 17.707699, C_cpu[0] = 16.042898
不匹配: C_gpu[1] = 18.975302, C_cpu[1] = 18.408001
不匹配: C_gpu[2] = 15.005199, C_cpu[2] = 14.782499
不匹配: C_gpu[3] = 14.322102, C_cpu[3] = 15.415499
不匹配: C_gpu[4] = 18.714701, C_cpu[4] = 17.851402
不匹配: C_gpu[5] = 17.257500, C_cpu[5] = 17.873299
不匹配: C_gpu[6] = 19.205999, C_cpu[6] = 17.017101
不匹配: C_gpu[7] = 16.937599, C_cpu[7] = 15.945598
不匹配: C_gpu[8] = 17.125900, C_cpu[8] = 15.463400
不匹配: C_gpu[9] = 18.169399, C_cpu[9] = 17.267298
验证失败: 发现 4092 个不匹配的元素 (总共 4096 个)

===== 测试 3: M=128, N=128, K=128 =====
执行 GPU 矩阵乘法...
初始化 cuBLAS...
执行 CPU 矩阵乘法...
不匹配: C_gpu[0] = 32.920998, C_cpu[0] = 30.158699
不匹配: C_gpu[1] = 33.973900, C_cpu[1] = 30.961901
不匹配: C_gpu[2] = 34.690304, C_cpu[2] = 29.714493
不匹配: C_gpu[3] = 33.179199, C_cpu[3] = 31.106096
不匹配: C_gpu[4] = 35.027100, C_cpu[4] = 31.495396
不匹配: C_gpu[5] = 30.134802, C_cpu[5] = 30.486597
不匹配: C_gpu[6] = 32.221500, C_cpu[6] = 29.334202
不匹配: C_gpu[7] = 33.867599, C_cpu[7] = 30.818701
不匹配: C_gpu[8] = 31.820198, C_cpu[8] = 30.145500
不匹配: C_gpu[9] = 32.023998, C_cpu[9] = 32.828606
验证失败: 发现 16377 个不匹配的元素 (总共 16384 个)

===== 测试 4: M=512, N=256, K=256 =====
执行 GPU 矩阵乘法...
初始化 cuBLAS...
执行 CPU 矩阵乘法...
不匹配: C_gpu[0] = 62.549698, C_cpu[0] = 60.830109
不匹配: C_gpu[1] = 66.983200, C_cpu[1] = 61.593185
不匹配: C_gpu[2] = 63.256901, C_cpu[2] = 62.463711
不匹配: C_gpu[3] = 71.834000, C_cpu[3] = 59.042686
不匹配: C_gpu[4] = 63.670399, C_cpu[4] = 63.307106
不匹配: C_gpu[5] = 63.449200, C_cpu[5] = 60.188190
不匹配: C_gpu[6] = 64.444092, C_cpu[6] = 67.696693
不匹配: C_gpu[7] = 63.993496, C_cpu[7] = 66.560493
不匹配: C_gpu[8] = 67.417496, C_cpu[8] = 61.547386
不匹配: C_gpu[9] = 64.319992, C_cpu[9] = 61.433891
验证失败: 发现 131049 个不匹配的元素 (总共 131072 个)

===== 测试 5: M=512, N=512, K=512 =====
执行 GPU 矩阵乘法...
初始化 cuBLAS...
执行 CPU 矩阵乘法...
不匹配: C_gpu[0] = 115.230095, C_cpu[0] = 124.727760
不匹配: C_gpu[1] = 123.773476, C_cpu[1] = 126.990463
不匹配: C_gpu[2] = 122.881798, C_cpu[2] = 131.276794
不匹配: C_gpu[3] = 125.155991, C_cpu[3] = 128.871689
不匹配: C_gpu[4] = 121.734184, C_cpu[4] = 126.845589
不匹配: C_gpu[5] = 128.181396, C_cpu[5] = 131.688034
不匹配: C_gpu[6] = 120.719589, C_cpu[6] = 130.446564
不匹配: C_gpu[7] = 123.210693, C_cpu[7] = 126.769470
不匹配: C_gpu[8] = 121.552910, C_cpu[8] = 128.783951
不匹配: C_gpu[9] = 122.911407, C_cpu[9] = 130.801514
验证失败: 发现 262106 个不匹配的元素 (总共 262144 个)

测试完成!

所有测试完成！
