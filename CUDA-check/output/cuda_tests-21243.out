=============== 环境信息 ===============
hepnode1
Fri Mar 28 09:58:53 PM CST 2025
CUDA 库路径: /usr/local/cuda/targets/x86_64-linux/lib:

=============== 基本 CUDA 功能测试 ===============
========= CUDA 基础功能测试 =========
检测到 1 个 CUDA 设备
设备 0: NVIDIA L40
  计算能力: 8.9
  全局内存: 44.64 GB
  多处理器数量: 142
  时钟频率: 2490 MHz
  显存总线宽度: 384 bits
CUDA 内核错误: the provided PTX was compiled with an unsupported toolchain.

=============== cuBLAS 矩阵乘法测试 ===============
========= cuBLAS 矩阵乘法测试 =========
CUDA 内存: 总计 44.64 GB, 可用 44.22 GB

测试矩阵大小: 32 x 32
矩阵 A (32x32):
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
...

矩阵 B (32x32):
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
...

执行 cublasSgemm (N=32)...
结果矩阵 C (32x32):
   32.00    32.00    32.00    32.00    32.00    32.00 ...
   32.00    32.00    32.00    32.00    32.00    32.00 ...
   32.00    32.00    32.00    32.00    32.00    32.00 ...
   32.00    32.00    32.00    32.00    32.00    32.00 ...
   32.00    32.00    32.00    32.00    32.00    32.00 ...
   32.00    32.00    32.00    32.00    32.00    32.00 ...
...

矩阵乘法验证通过 (N=32)！

测试矩阵大小: 256 x 256
执行 cublasSgemm (N=256)...
矩阵乘法验证通过 (N=256)！

测试矩阵大小: 1024 x 1024
执行 cublasSgemm (N=1024)...
矩阵乘法验证通过 (N=1024)！

测试矩阵大小: 4096 x 4096
执行 cublasSgemm (N=4096)...
矩阵乘法验证通过 (N=4096)！

cuBLAS 测试完成!

=============== 特定 sgemm_cublas 函数测试 ===============
 ** On entry to SGEMM  parameter number 10 had an illegal value
GPU result:
0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 
CPU result:
0.478282 0.349142 0.396021 
0.486280 0.471621 0.205251 
1.997019 1.770361 1.170949 
1.733665 1.373531 0.814480 
1.549361 1.233488 0.968243 
1.462910 1.010310 0.591000 
Matrices differ at (0, 0): 0.478282 vs 0.000000
Matrices differ at (0, 1): 0.349142 vs 0.000000
Matrices differ at (0, 2): 0.396021 vs 0.000000
Matrices differ at (1, 0): 0.486280 vs 0.000000
Matrices differ at (1, 1): 0.471621 vs 0.000000
Matrices differ at (1, 2): 0.205251 vs 0.000000
Matrices differ at (2, 0): 1.997019 vs 0.000000
Matrices differ at (2, 1): 1.770361 vs 0.000000
Matrices differ at (2, 2): 1.170949 vs 0.000000
Matrices differ at (3, 0): 1.733665 vs 0.000000
Matrices differ at (3, 1): 1.373531 vs 0.000000
Matrices differ at (3, 2): 0.814480 vs 0.000000
Matrices differ at (4, 0): 1.549361 vs 0.000000
Matrices differ at (4, 1): 1.233488 vs 0.000000
Matrices differ at (4, 2): 0.968243 vs 0.000000
Matrices differ at (5, 0): 1.462910 vs 0.000000
Matrices differ at (5, 1): 1.010310 vs 0.000000
Matrices differ at (5, 2): 0.591000 vs 0.000000

所有测试完成！
