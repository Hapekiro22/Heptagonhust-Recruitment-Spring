=============== 环境信息 ===============
hepnode1
Fri Mar 28 08:09:51 PM CST 2025
CUDA 库路径: /usr/local/cuda/targets/x86_64-linux/lib:

=============== 基本 CUDA 功能测试 ===============
========= CUDA 基础功能测试 =========
检测到 1 个 CUDA 设备
设备 0: NVIDIA L40
  计算能力: 8.9
  全局内存: 44.64 GB
  多处理器数量: 142
  时钟频率: 2490 MHz
  显存总线宽度: 384 bits
CUDA 内核错误: the provided PTX was compiled with an unsupported toolchain.

=============== cuBLAS 矩阵乘法测试 ===============
========= cuBLAS 矩阵乘法测试 =========
CUDA 内存: 总计 44.64 GB, 可用 44.22 GB

测试矩阵大小: 32 x 32
矩阵 A (32x32):
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
...

矩阵 B (32x32):
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
    1.00     1.00     1.00     1.00     1.00     1.00 ...
...

执行 cublasSgemm (N=32)...
结果矩阵 C (32x32):
   32.00    32.00    32.00    32.00    32.00    32.00 ...
   32.00    32.00    32.00    32.00    32.00    32.00 ...
   32.00    32.00    32.00    32.00    32.00    32.00 ...
   32.00    32.00    32.00    32.00    32.00    32.00 ...
   32.00    32.00    32.00    32.00    32.00    32.00 ...
   32.00    32.00    32.00    32.00    32.00    32.00 ...
...

矩阵乘法验证通过 (N=32)！

测试矩阵大小: 256 x 256
执行 cublasSgemm (N=256)...
矩阵乘法验证通过 (N=256)！

测试矩阵大小: 1024 x 1024
执行 cublasSgemm (N=1024)...
矩阵乘法验证通过 (N=1024)！

测试矩阵大小: 4096 x 4096
执行 cublasSgemm (N=4096)...
矩阵乘法验证通过 (N=4096)！

cuBLAS 测试完成!

=============== 特定 sgemm_cublas 函数测试 ===============
========= 测试你的 sgemm_cublas 函数 =========


===== 测试 1: M=5, N=3, K=2 =====
矩阵 A (5x2):
    0.83     0.86 
    0.77     0.15 
    0.93     0.35 
    0.86     0.92 
    0.49     0.21 
矩阵 B (3x2):
    0.62     0.27 
    0.90     0.59 
    0.63     0.26 
执行 GPU 矩阵乘法...
执行 CPU 矩阵乘法...
GPU 结果 (3x5):
    0.00     0.00     0.00     0.00     0.00     0.00     0.00     0.00     0.00     0.00     0.00     0.00     0.00     0.00     0.00 CPU 结果 (3x5):
    0.75     0.52     0.67     0.78     0.36     1.25     0.78     1.04     1.32     0.56     0.75     0.52     0.68     0.78     0.36 不匹配: C_gpu[0] = 0.000000, C_cpu[0] = 0.746800
不匹配: C_gpu[1] = 0.000000, C_cpu[1] = 0.517900
不匹配: C_gpu[2] = 0.000000, C_cpu[2] = 0.671100
不匹配: C_gpu[3] = 0.000000, C_cpu[3] = 0.781600
不匹配: C_gpu[4] = 0.000000, C_cpu[4] = 0.360500
不匹配: C_gpu[5] = 0.000000, C_cpu[5] = 1.254400
不匹配: C_gpu[6] = 0.000000, C_cpu[6] = 0.781500
不匹配: C_gpu[7] = 0.000000, C_cpu[7] = 1.043500
不匹配: C_gpu[8] = 0.000000, C_cpu[8] = 1.316800
不匹配: C_gpu[9] = 0.000000, C_cpu[9] = 0.564900
验证失败: 发现 15 个不匹配的元素 (总共 15 个)

===== 测试 2: M=64, N=64, K=64 =====
执行 GPU 矩阵乘法...
执行 CPU 矩阵乘法...
不匹配: C_gpu[0] = 0.000000, C_cpu[0] = 15.736097
不匹配: C_gpu[1] = 0.000000, C_cpu[1] = 17.557400
不匹配: C_gpu[2] = 0.000000, C_cpu[2] = 14.502600
不匹配: C_gpu[3] = 0.000000, C_cpu[3] = 14.914000
不匹配: C_gpu[4] = 0.000000, C_cpu[4] = 17.058300
不匹配: C_gpu[5] = 0.000000, C_cpu[5] = 17.778702
不匹配: C_gpu[6] = 0.000000, C_cpu[6] = 16.321501
不匹配: C_gpu[7] = 0.000000, C_cpu[7] = 16.121298
不匹配: C_gpu[8] = 0.000000, C_cpu[8] = 15.377600
不匹配: C_gpu[9] = 0.000000, C_cpu[9] = 17.529900
验证失败: 发现 4096 个不匹配的元素 (总共 4096 个)

===== 测试 3: M=128, N=128, K=128 =====
执行 GPU 矩阵乘法...
执行 CPU 矩阵乘法...
不匹配: C_gpu[0] = 0.000000, C_cpu[0] = 30.793898
不匹配: C_gpu[1] = 0.000000, C_cpu[1] = 29.667696
不匹配: C_gpu[2] = 0.000000, C_cpu[2] = 30.332699
不匹配: C_gpu[3] = 0.000000, C_cpu[3] = 30.311592
不匹配: C_gpu[4] = 0.000000, C_cpu[4] = 30.326000
不匹配: C_gpu[5] = 0.000000, C_cpu[5] = 31.575796
不匹配: C_gpu[6] = 0.000000, C_cpu[6] = 29.040907
不匹配: C_gpu[7] = 0.000000, C_cpu[7] = 31.296801
不匹配: C_gpu[8] = 0.000000, C_cpu[8] = 29.198202
不匹配: C_gpu[9] = 0.000000, C_cpu[9] = 31.667305
验证失败: 发现 16384 个不匹配的元素 (总共 16384 个)

===== 测试 4: M=512, N=256, K=256 =====
执行 GPU 矩阵乘法...
执行 CPU 矩阵乘法...
不匹配: C_gpu[0] = 0.000000, C_cpu[0] = 59.708210
不匹配: C_gpu[1] = 0.000000, C_cpu[1] = 61.694878
不匹配: C_gpu[2] = 0.000000, C_cpu[2] = 61.909512
不匹配: C_gpu[3] = 0.000000, C_cpu[3] = 59.397400
不匹配: C_gpu[4] = 0.000000, C_cpu[4] = 62.751911
不匹配: C_gpu[5] = 0.000000, C_cpu[5] = 59.649597
不匹配: C_gpu[6] = 0.000000, C_cpu[6] = 66.996979
不匹配: C_gpu[7] = 0.000000, C_cpu[7] = 65.579208
不匹配: C_gpu[8] = 0.000000, C_cpu[8] = 62.085079
不匹配: C_gpu[9] = 0.000000, C_cpu[9] = 61.714600
验证失败: 发现 131072 个不匹配的元素 (总共 131072 个)

===== 测试 5: M=512, N=512, K=512 =====
执行 GPU 矩阵乘法...
执行 CPU 矩阵乘法...
不匹配: C_gpu[0] = 0.000000, C_cpu[0] = 123.906761
不匹配: C_gpu[1] = 0.000000, C_cpu[1] = 127.169678
不匹配: C_gpu[2] = 0.000000, C_cpu[2] = 130.602310
不匹配: C_gpu[3] = 0.000000, C_cpu[3] = 127.691002
不匹配: C_gpu[4] = 0.000000, C_cpu[4] = 125.454193
不匹配: C_gpu[5] = 0.000000, C_cpu[5] = 130.994644
不匹配: C_gpu[6] = 0.000000, C_cpu[6] = 131.228546
不匹配: C_gpu[7] = 0.000000, C_cpu[7] = 127.240982
不匹配: C_gpu[8] = 0.000000, C_cpu[8] = 127.511047
不匹配: C_gpu[9] = 0.000000, C_cpu[9] = 130.557526
验证失败: 发现 262144 个不匹配的元素 (总共 262144 个)

测试完成!

所有测试完成！
